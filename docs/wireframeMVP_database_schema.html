<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
      FreelanceOS - Database Schema for Psychological Tracking Systems
    </title>
    <style>
      :root {
        --primary: #007bff;
        --success: #28a745;
        --warning: #ffc107;
        --danger: #dc3545;
        --info: #17a2b8;
        --dark: #343a40;
        --light: #f8f9fa;
        --purple: #6f42c1;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family:
          -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        background: #f0f2f5;
        color: #333;
        line-height: 1.6;
      }

      .container {
        max-width: 1600px;
        margin: 0 auto;
        padding: 20px;
      }

      .header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 60px 40px;
        border-radius: 16px;
        margin-bottom: 40px;
        text-align: center;
      }

      .schema-section {
        background: white;
        border-radius: 16px;
        padding: 40px;
        margin-bottom: 30px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.07);
      }

      .schema-table {
        background: #f8f9fa;
        border: 2px solid #dee2e6;
        border-radius: 12px;
        padding: 20px;
        margin: 20px 0;
        overflow-x: auto;
      }

      .table-header {
        background: linear-gradient(135deg, #007bff, #0056b3);
        color: white;
        padding: 15px 20px;
        margin: -20px -20px 20px -20px;
        border-radius: 10px 10px 0 0;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
      }

      th,
      td {
        padding: 12px;
        text-align: left;
        border-bottom: 1px solid #dee2e6;
      }

      th {
        background: #e9ecef;
        font-weight: 600;
        color: #495057;
      }

      tr:last-child td {
        border-bottom: none;
      }

      .field-name {
        font-family: "Consolas", "Monaco", monospace;
        font-weight: 600;
        color: #e83e8c;
      }

      .field-type {
        font-family: "Consolas", "Monaco", monospace;
        color: #20c997;
        font-size: 14px;
      }

      .field-key {
        display: inline-block;
        padding: 2px 8px;
        border-radius: 4px;
        font-size: 12px;
        font-weight: 600;
      }

      .pk {
        background: #ffc107;
        color: #333;
      }

      .fk {
        background: #17a2b8;
        color: white;
      }

      .idx {
        background: #6c757d;
        color: white;
      }

      .code-block {
        background: #1e1e1e;
        color: #d4d4d4;
        padding: 24px;
        border-radius: 8px;
        overflow-x: auto;
        margin: 20px 0;
        font-family: "Consolas", "Monaco", monospace;
        font-size: 14px;
        line-height: 1.6;
      }

      .relationship {
        background: #e7f3ff;
        border: 2px solid #007bff;
        border-radius: 8px;
        padding: 15px;
        margin: 15px 0;
      }

      .grid {
        display: grid;
        gap: 20px;
      }

      .grid-2 {
        grid-template-columns: repeat(2, 1fr);
      }

      .note {
        background: #fff3cd;
        border-left: 4px solid #ffc107;
        padding: 15px;
        margin: 20px 0;
        border-radius: 0 8px 8px 0;
      }

      .enum-values {
        background: #f8f9fa;
        padding: 10px;
        border-radius: 6px;
        margin-top: 5px;
        font-size: 14px;
        font-family: "Consolas", "Monaco", monospace;
      }

      .index-info {
        background: #d1ecf1;
        border: 1px solid #bee5eb;
        border-radius: 6px;
        padding: 15px;
        margin: 15px 0;
      }

      @media (max-width: 768px) {
        .grid-2 {
          grid-template-columns: 1fr;
        }

        .schema-section {
          padding: 20px;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- Header -->
      <div class="header">
        <h1 style="font-size: 48px; margin-bottom: 20px">
          FreelanceOS Database Schema
        </h1>
        <p style="font-size: 20px; opacity: 0.9">
          Complete Psychological Tracking System Architecture
        </p>
      </div>

      <!-- Overview Section -->
      <div class="schema-section">
        <h2 style="font-size: 32px; margin-bottom: 20px">
          Database Architecture Overview
        </h2>
        <p style="font-size: 18px; color: #6c757d; margin-bottom: 20px">
          The FreelanceOS database is designed to capture and track the complete
          psychological journey of freelancers, enabling real-time interventions
          and personalized support.
        </p>

        <div class="grid grid-2">
          <div>
            <h3>Core Principles</h3>
            <ul style="padding-left: 20px; margin-top: 10px">
              <li>Time-series data for psychological state tracking</li>
              <li>Event-driven architecture for interventions</li>
              <li>Flexible schema for personalization</li>
              <li>Privacy-first design with data anonymization</li>
              <li>High-performance queries for real-time analysis</li>
            </ul>
          </div>
          <div>
            <h3>Technology Stack</h3>
            <ul style="padding-left: 20px; margin-top: 10px">
              <li><strong>Primary DB:</strong> PostgreSQL 14+</li>
              <li><strong>Time-series:</strong> TimescaleDB</li>
              <li><strong>Cache:</strong> Redis</li>
              <li><strong>Analytics:</strong> ClickHouse</li>
              <li><strong>Search:</strong> Elasticsearch</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- Core User Psychology Schema -->
      <div class="schema-section">
        <h2 style="font-size: 28px; margin-bottom: 20px">
          1. Core User Psychology Tables
        </h2>

        <!-- Users Table -->
        <div class="schema-table">
          <div class="table-header">
            <h3>users</h3>
            <p style="font-size: 14px; opacity: 0.9">
              Core user information with psychological profiling
            </p>
          </div>
          <table>
            <thead>
              <tr>
                <th>Field</th>
                <th>Type</th>
                <th>Constraints</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="field-name">id</span></td>
                <td><span class="field-type">UUID</span></td>
                <td><span class="field-key pk">PK</span></td>
                <td>Unique user identifier</td>
              </tr>
              <tr>
                <td><span class="field-name">email</span></td>
                <td><span class="field-type">VARCHAR(255)</span></td>
                <td>UNIQUE, NOT NULL</td>
                <td>User email address</td>
              </tr>
              <tr>
                <td><span class="field-name">personality_type</span></td>
                <td><span class="field-type">ENUM</span></td>
                <td>DEFAULT 'analytical'</td>
                <td>Primary personality classification</td>
              </tr>
              <tr>
                <td><span class="field-name">experience_level</span></td>
                <td><span class="field-type">ENUM</span></td>
                <td>NOT NULL</td>
                <td>Freelancer experience: beginner, intermediate, expert</td>
              </tr>
              <tr>
                <td><span class="field-name">user_segment</span></td>
                <td><span class="field-type">VARCHAR(50)</span></td>
                <td><span class="field-key idx">IDX</span></td>
                <td>User segment for targeted features</td>
              </tr>
              <tr>
                <td><span class="field-name">onboarding_completed_at</span></td>
                <td><span class="field-type">TIMESTAMP</span></td>
                <td>NULL</td>
                <td>When user completed onboarding</td>
              </tr>
              <tr>
                <td><span class="field-name">created_at</span></td>
                <td><span class="field-type">TIMESTAMP</span></td>
                <td>DEFAULT NOW()</td>
                <td>Account creation timestamp</td>
              </tr>
              <tr>
                <td><span class="field-name">last_active_at</span></td>
                <td><span class="field-type">TIMESTAMP</span></td>
                <td><span class="field-key idx">IDX</span></td>
                <td>Last activity timestamp</td>
              </tr>
            </tbody>
          </table>
          <div class="enum-values">
            <strong>personality_type:</strong> 'analytical' | 'creative' |
            'time_starved' | 'budget_conscious' | 'agency' | 'executive'<br />
            <strong>experience_level:</strong> 'beginner' | 'intermediate' |
            'expert' | 'agency_owner'<br />
            <strong>user_segment:</strong> 'new_freelancer' | 'experienced' |
            'struggling' | 'parent' | 'neurodiverse' | 'high_performer'
          </div>
        </div>

        <!-- User Psychology Profiles -->
        <div class="schema-table">
          <div class="table-header">
            <h3>user_psychology_profiles</h3>
            <p style="font-size: 14px; opacity: 0.9">
              Detailed psychological profiling and preferences
            </p>
          </div>
          <table>
            <thead>
              <tr>
                <th>Field</th>
                <th>Type</th>
                <th>Constraints</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="field-name">user_id</span></td>
                <td><span class="field-type">UUID</span></td>
                <td>
                  <span class="field-key pk">PK</span>
                  <span class="field-key fk">FK</span>
                </td>
                <td>References users.id</td>
              </tr>
              <tr>
                <td><span class="field-name">risk_tolerance</span></td>
                <td><span class="field-type">DECIMAL(3,2)</span></td>
                <td>CHECK (0-1)</td>
                <td>Risk tolerance score (0=low, 1=high)</td>
              </tr>
              <tr>
                <td><span class="field-name">rejection_sensitivity</span></td>
                <td><span class="field-type">DECIMAL(3,2)</span></td>
                <td>CHECK (0-1)</td>
                <td>How sensitive to rejection</td>
              </tr>
              <tr>
                <td><span class="field-name">motivation_type</span></td>
                <td><span class="field-type">ENUM</span></td>
                <td>NOT NULL</td>
                <td>Primary motivation driver</td>
              </tr>
              <tr>
                <td><span class="field-name">work_style</span></td>
                <td><span class="field-type">JSONB</span></td>
                <td>DEFAULT '{}'</td>
                <td>Work preferences and patterns</td>
              </tr>
              <tr>
                <td><span class="field-name">stress_triggers</span></td>
                <td><span class="field-type">TEXT[]</span></td>
                <td>DEFAULT '{}'</td>
                <td>Known stress triggers</td>
              </tr>
              <tr>
                <td><span class="field-name">support_preferences</span></td>
                <td><span class="field-type">JSONB</span></td>
                <td>DEFAULT '{}'</td>
                <td>Preferred support methods</td>
              </tr>
              <tr>
                <td><span class="field-name">updated_at</span></td>
                <td><span class="field-type">TIMESTAMP</span></td>
                <td>DEFAULT NOW()</td>
                <td>Last profile update</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Confidence & Emotional State Tracking -->
      <div class="schema-section">
        <h2 style="font-size: 28px; margin-bottom: 20px">
          2. Confidence & Emotional State Tracking
        </h2>

        <!-- Confidence Scores -->
        <div class="schema-table">
          <div class="table-header">
            <h3>confidence_scores</h3>
            <p style="font-size: 14px; opacity: 0.9">
              Time-series confidence tracking
            </p>
          </div>
          <table>
            <thead>
              <tr>
                <th>Field</th>
                <th>Type</th>
                <th>Constraints</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="field-name">id</span></td>
                <td><span class="field-type">BIGSERIAL</span></td>
                <td><span class="field-key pk">PK</span></td>
                <td>Auto-incrementing ID</td>
              </tr>
              <tr>
                <td><span class="field-name">user_id</span></td>
                <td><span class="field-type">UUID</span></td>
                <td>
                  <span class="field-key fk">FK</span>
                  <span class="field-key idx">IDX</span>
                </td>
                <td>References users.id</td>
              </tr>
              <tr>
                <td><span class="field-name">score</span></td>
                <td><span class="field-type">INTEGER</span></td>
                <td>CHECK (0-100)</td>
                <td>Overall confidence score</td>
              </tr>
              <tr>
                <td><span class="field-name">components</span></td>
                <td><span class="field-type">JSONB</span></td>
                <td>NOT NULL</td>
                <td>Breakdown of score components</td>
              </tr>
              <tr>
                <td><span class="field-name">context</span></td>
                <td><span class="field-type">JSONB</span></td>
                <td>DEFAULT '{}'</td>
                <td>Contextual factors at time of measurement</td>
              </tr>
              <tr>
                <td><span class="field-name">recorded_at</span></td>
                <td><span class="field-type">TIMESTAMP</span></td>
                <td><span class="field-key idx">IDX</span> DEFAULT NOW()</td>
                <td>When score was recorded</td>
              </tr>
            </tbody>
          </table>
          <div class="note">
            <strong>Note:</strong> This table uses TimescaleDB hypertable for
            efficient time-series queries. Partitioned by recorded_at with 7-day
            chunks.
          </div>
        </div>

        <!-- Mood Tracking -->
        <div class="schema-table">
          <div class="table-header">
            <h3>mood_entries</h3>
            <p style="font-size: 14px; opacity: 0.9">
              User mood and energy tracking
            </p>
          </div>
          <table>
            <thead>
              <tr>
                <th>Field</th>
                <th>Type</th>
                <th>Constraints</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="field-name">id</span></td>
                <td><span class="field-type">BIGSERIAL</span></td>
                <td><span class="field-key pk">PK</span></td>
                <td>Auto-incrementing ID</td>
              </tr>
              <tr>
                <td><span class="field-name">user_id</span></td>
                <td><span class="field-type">UUID</span></td>
                <td>
                  <span class="field-key fk">FK</span>
                  <span class="field-key idx">IDX</span>
                </td>
                <td>References users.id</td>
              </tr>
              <tr>
                <td><span class="field-name">mood_value</span></td>
                <td><span class="field-type">INTEGER</span></td>
                <td>CHECK (1-5)</td>
                <td>Mood rating (1=very low, 5=very high)</td>
              </tr>
              <tr>
                <td><span class="field-name">energy_level</span></td>
                <td><span class="field-type">INTEGER</span></td>
                <td>CHECK (1-5)</td>
                <td>Energy level rating</td>
              </tr>
              <tr>
                <td><span class="field-name">stress_level</span></td>
                <td><span class="field-type">INTEGER</span></td>
                <td>CHECK (1-5)</td>
                <td>Stress level (1=low, 5=high)</td>
              </tr>
              <tr>
                <td><span class="field-name">trigger_event</span></td>
                <td><span class="field-type">VARCHAR(100)</span></td>
                <td>NULL</td>
                <td>What triggered this mood entry</td>
              </tr>
              <tr>
                <td><span class="field-name">notes</span></td>
                <td><span class="field-type">TEXT</span></td>
                <td>NULL</td>
                <td>Optional user notes</td>
              </tr>
              <tr>
                <td><span class="field-name">recorded_at</span></td>
                <td><span class="field-type">TIMESTAMP</span></td>
                <td><span class="field-key idx">IDX</span> DEFAULT NOW()</td>
                <td>Entry timestamp</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Psychological States -->
        <div class="schema-table">
          <div class="table-header">
            <h3>psychological_states</h3>
            <p style="font-size: 14px; opacity: 0.9">
              Comprehensive psychological state snapshots
            </p>
          </div>
          <table>
            <thead>
              <tr>
                <th>Field</th>
                <th>Type</th>
                <th>Constraints</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="field-name">id</span></td>
                <td><span class="field-type">BIGSERIAL</span></td>
                <td><span class="field-key pk">PK</span></td>
                <td>Auto-incrementing ID</td>
              </tr>
              <tr>
                <td><span class="field-name">user_id</span></td>
                <td><span class="field-type">UUID</span></td>
                <td>
                  <span class="field-key fk">FK</span>
                  <span class="field-key idx">IDX</span>
                </td>
                <td>References users.id</td>
              </tr>
              <tr>
                <td><span class="field-name">confidence_score</span></td>
                <td><span class="field-type">INTEGER</span></td>
                <td>CHECK (0-100)</td>
                <td>Current confidence level</td>
              </tr>
              <tr>
                <td><span class="field-name">resilience_score</span></td>
                <td><span class="field-type">INTEGER</span></td>
                <td>CHECK (0-100)</td>
                <td>Resilience measurement</td>
              </tr>
              <tr>
                <td><span class="field-name">motivation_level</span></td>
                <td><span class="field-type">INTEGER</span></td>
                <td>CHECK (0-100)</td>
                <td>Current motivation</td>
              </tr>
              <tr>
                <td><span class="field-name">burnout_risk</span></td>
                <td><span class="field-type">DECIMAL(3,2)</span></td>
                <td>CHECK (0-1)</td>
                <td>Burnout risk probability</td>
              </tr>
              <tr>
                <td><span class="field-name">mindset_position</span></td>
                <td><span class="field-type">INTEGER</span></td>
                <td>CHECK (-100 to 100)</td>
                <td>Scarcity (-100) to Abundance (100)</td>
              </tr>
              <tr>
                <td><span class="field-name">state_factors</span></td>
                <td><span class="field-type">JSONB</span></td>
                <td>NOT NULL</td>
                <td>Detailed state components</td>
              </tr>
              <tr>
                <td><span class="field-name">recorded_at</span></td>
                <td><span class="field-type">TIMESTAMP</span></td>
                <td><span class="field-key idx">IDX</span> DEFAULT NOW()</td>
                <td>State snapshot time</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Behavioral Tracking -->
      <div class="schema-section">
        <h2 style="font-size: 28px; margin-bottom: 20px">
          3. Behavioral Pattern Tracking
        </h2>

        <!-- Application Patterns -->
        <div class="schema-table">
          <div class="table-header">
            <h3>application_behaviors</h3>
            <p style="font-size: 14px; opacity: 0.9">
              Job application patterns and behaviors
            </p>
          </div>
          <table>
            <thead>
              <tr>
                <th>Field</th>
                <th>Type</th>
                <th>Constraints</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="field-name">id</span></td>
                <td><span class="field-type">BIGSERIAL</span></td>
                <td><span class="field-key pk">PK</span></td>
                <td>Auto-incrementing ID</td>
              </tr>
              <tr>
                <td><span class="field-name">user_id</span></td>
                <td><span class="field-type">UUID</span></td>
                <td>
                  <span class="field-key fk">FK</span>
                  <span class="field-key idx">IDX</span>
                </td>
                <td>References users.id</td>
              </tr>
              <tr>
                <td><span class="field-name">job_id</span></td>
                <td><span class="field-type">UUID</span></td>
                <td><span class="field-key fk">FK</span></td>
                <td>References jobs.id</td>
              </tr>
              <tr>
                <td><span class="field-name">action_type</span></td>
                <td><span class="field-type">ENUM</span></td>
                <td>NOT NULL</td>
                <td>Type of action taken</td>
              </tr>
              <tr>
                <td><span class="field-name">time_to_action</span></td>
                <td><span class="field-type">INTERVAL</span></td>
                <td>NULL</td>
                <td>Time from job view to action</td>
              </tr>
              <tr>
                <td><span class="field-name">confidence_at_action</span></td>
                <td><span class="field-type">INTEGER</span></td>
                <td>NULL</td>
                <td>User confidence when acting</td>
              </tr>
              <tr>
                <td><span class="field-name">match_score</span></td>
                <td><span class="field-type">INTEGER</span></td>
                <td>CHECK (0-100)</td>
                <td>Job match score</td>
              </tr>
              <tr>
                <td><span class="field-name">outcome</span></td>
                <td><span class="field-type">ENUM</span></td>
                <td>NULL</td>
                <td>Application outcome</td>
              </tr>
              <tr>
                <td><span class="field-name">created_at</span></td>
                <td><span class="field-type">TIMESTAMP</span></td>
                <td>DEFAULT NOW()</td>
                <td>Action timestamp</td>
              </tr>
            </tbody>
          </table>
          <div class="enum-values">
            <strong>action_type:</strong> 'viewed' | 'saved' | 'applied' |
            'skipped' | 'withdrew'<br />
            <strong>outcome:</strong> 'pending' | 'interview' | 'hired' |
            'rejected' | 'ghosted'
          </div>
        </div>

        <!-- Streak Tracking -->
        <div class="schema-table">
          <div class="table-header">
            <h3>user_streaks</h3>
            <p style="font-size: 14px; opacity: 0.9">
              Winning and losing streak management
            </p>
          </div>
          <table>
            <thead>
              <tr>
                <th>Field</th>
                <th>Type</th>
                <th>Constraints</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="field-name">id</span></td>
                <td><span class="field-type">UUID</span></td>
                <td><span class="field-key pk">PK</span></td>
                <td>Unique streak ID</td>
              </tr>
              <tr>
                <td><span class="field-name">user_id</span></td>
                <td><span class="field-type">UUID</span></td>
                <td>
                  <span class="field-key fk">FK</span>
                  <span class="field-key idx">IDX</span>
                </td>
                <td>References users.id</td>
              </tr>
              <tr>
                <td><span class="field-name">streak_type</span></td>
                <td><span class="field-type">ENUM</span></td>
                <td>NOT NULL</td>
                <td>Type of streak</td>
              </tr>
              <tr>
                <td><span class="field-name">current_count</span></td>
                <td><span class="field-type">INTEGER</span></td>
                <td>DEFAULT 0</td>
                <td>Current streak length</td>
              </tr>
              <tr>
                <td><span class="field-name">best_count</span></td>
                <td><span class="field-type">INTEGER</span></td>
                <td>DEFAULT 0</td>
                <td>Best streak achieved</td>
              </tr>
              <tr>
                <td><span class="field-name">started_at</span></td>
                <td><span class="field-type">TIMESTAMP</span></td>
                <td>NOT NULL</td>
                <td>When current streak started</td>
              </tr>
              <tr>
                <td><span class="field-name">last_event_at</span></td>
                <td><span class="field-type">TIMESTAMP</span></td>
                <td>NOT NULL</td>
                <td>Last streak event</td>
              </tr>
              <tr>
                <td><span class="field-name">intervention_triggered</span></td>
                <td><span class="field-type">BOOLEAN</span></td>
                <td>DEFAULT FALSE</td>
                <td>If intervention was triggered</td>
              </tr>
            </tbody>
          </table>
          <div class="enum-values">
            <strong>streak_type:</strong> 'wins' | 'losses' | 'applications' |
            'logins' | 'proposals' | 'follow_ups'
          </div>
        </div>

        <!-- Habit Tracking -->
        <div class="schema-table">
          <div class="table-header">
            <h3>habit_tracking</h3>
            <p style="font-size: 14px; opacity: 0.9">
              Daily habit formation and tracking
            </p>
          </div>
          <table>
            <thead>
              <tr>
                <th>Field</th>
                <th>Type</th>
                <th>Constraints</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="field-name">id</span></td>
                <td><span class="field-type">BIGSERIAL</span></td>
                <td><span class="field-key pk">PK</span></td>
                <td>Auto-incrementing ID</td>
              </tr>
              <tr>
                <td><span class="field-name">user_id</span></td>
                <td><span class="field-type">UUID</span></td>
                <td>
                  <span class="field-key fk">FK</span>
                  <span class="field-key idx">IDX</span>
                </td>
                <td>References users.id</td>
              </tr>
              <tr>
                <td><span class="field-name">habit_type</span></td>
                <td><span class="field-type">VARCHAR(50)</span></td>
                <td>NOT NULL</td>
                <td>Type of habit being tracked</td>
              </tr>
              <tr>
                <td><span class="field-name">target_time</span></td>
                <td><span class="field-type">TIME</span></td>
                <td>NULL</td>
                <td>Preferred time for habit</td>
              </tr>
              <tr>
                <td><span class="field-name">completed_at</span></td>
                <td><span class="field-type">TIMESTAMP</span></td>
                <td>NULL</td>
                <td>When habit was completed</td>
              </tr>
              <tr>
                <td><span class="field-name">streak_days</span></td>
                <td><span class="field-type">INTEGER</span></td>
                <td>DEFAULT 0</td>
                <td>Current streak in days</td>
              </tr>
              <tr>
                <td><span class="field-name">completion_rate</span></td>
                <td><span class="field-type">DECIMAL(3,2)</span></td>
                <td>DEFAULT 0</td>
                <td>21-day completion rate</td>
              </tr>
              <tr>
                <td><span class="field-name">date</span></td>
                <td><span class="field-type">DATE</span></td>
                <td><span class="field-key idx">IDX</span></td>
                <td>Date for this habit entry</td>
              </tr>
            </tbody>
          </table>
          <div class="index-info">
            <strong>Unique Index:</strong> (user_id, habit_type, date) - One
            entry per habit per day
          </div>
        </div>
      </div>

      <!-- Intervention System -->
      <div class="schema-section">
        <h2 style="font-size: 28px; margin-bottom: 20px">
          4. Intervention & Support System
        </h2>

        <!-- Interventions -->
        <div class="schema-table">
          <div class="table-header">
            <h3>interventions</h3>
            <p style="font-size: 14px; opacity: 0.9">
              Psychological intervention tracking
            </p>
          </div>
          <table>
            <thead>
              <tr>
                <th>Field</th>
                <th>Type</th>
                <th>Constraints</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="field-name">id</span></td>
                <td><span class="field-type">UUID</span></td>
                <td><span class="field-key pk">PK</span></td>
                <td>Unique intervention ID</td>
              </tr>
              <tr>
                <td><span class="field-name">user_id</span></td>
                <td><span class="field-type">UUID</span></td>
                <td>
                  <span class="field-key fk">FK</span>
                  <span class="field-key idx">IDX</span>
                </td>
                <td>References users.id</td>
              </tr>
              <tr>
                <td><span class="field-name">intervention_type</span></td>
                <td><span class="field-type">VARCHAR(50)</span></td>
                <td>NOT NULL</td>
                <td>Type of intervention</td>
              </tr>
              <tr>
                <td><span class="field-name">trigger_event</span></td>
                <td><span class="field-type">VARCHAR(100)</span></td>
                <td>NOT NULL</td>
                <td>What triggered intervention</td>
              </tr>
              <tr>
                <td><span class="field-name">trigger_context</span></td>
                <td><span class="field-type">JSONB</span></td>
                <td>NOT NULL</td>
                <td>Context at trigger time</td>
              </tr>
              <tr>
                <td><span class="field-name">content</span></td>
                <td><span class="field-type">JSONB</span></td>
                <td>NOT NULL</td>
                <td>Intervention content/message</td>
              </tr>
              <tr>
                <td><span class="field-name">delivery_channel</span></td>
                <td><span class="field-type">ENUM</span></td>
                <td>NOT NULL</td>
                <td>How intervention was delivered</td>
              </tr>
              <tr>
                <td><span class="field-name">user_response</span></td>
                <td><span class="field-type">VARCHAR(50)</span></td>
                <td>NULL</td>
                <td>How user responded</td>
              </tr>
              <tr>
                <td><span class="field-name">effectiveness_score</span></td>
                <td><span class="field-type">INTEGER</span></td>
                <td>CHECK (0-100)</td>
                <td>Measured effectiveness</td>
              </tr>
              <tr>
                <td><span class="field-name">created_at</span></td>
                <td><span class="field-type">TIMESTAMP</span></td>
                <td>DEFAULT NOW()</td>
                <td>When intervention triggered</td>
              </tr>
              <tr>
                <td><span class="field-name">responded_at</span></td>
                <td><span class="field-type">TIMESTAMP</span></td>
                <td>NULL</td>
                <td>When user responded</td>
              </tr>
            </tbody>
          </table>
          <div class="enum-values">
            <strong>delivery_channel:</strong> 'in_app' | 'email' | 'push' |
            'sms' | 'dashboard'
          </div>
        </div>

        <!-- Intervention Templates -->
        <div class="schema-table">
          <div class="table-header">
            <h3>intervention_templates</h3>
            <p style="font-size: 14px; opacity: 0.9">
              Reusable intervention content templates
            </p>
          </div>
          <table>
            <thead>
              <tr>
                <th>Field</th>
                <th>Type</th>
                <th>Constraints</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="field-name">id</span></td>
                <td><span class="field-type">UUID</span></td>
                <td><span class="field-key pk">PK</span></td>
                <td>Template ID</td>
              </tr>
              <tr>
                <td><span class="field-name">name</span></td>
                <td><span class="field-type">VARCHAR(100)</span></td>
                <td>UNIQUE</td>
                <td>Template name</td>
              </tr>
              <tr>
                <td><span class="field-name">trigger_condition</span></td>
                <td><span class="field-type">JSONB</span></td>
                <td>NOT NULL</td>
                <td>When to use this template</td>
              </tr>
              <tr>
                <td><span class="field-name">content_template</span></td>
                <td><span class="field-type">JSONB</span></td>
                <td>NOT NULL</td>
                <td>Template with variables</td>
              </tr>
              <tr>
                <td><span class="field-name">personality_types</span></td>
                <td><span class="field-type">TEXT[]</span></td>
                <td>DEFAULT '{}'</td>
                <td>Suitable personality types</td>
              </tr>
              <tr>
                <td><span class="field-name">effectiveness_data</span></td>
                <td><span class="field-type">JSONB</span></td>
                <td>DEFAULT '{}'</td>
                <td>Historical effectiveness</td>
              </tr>
              <tr>
                <td><span class="field-name">active</span></td>
                <td><span class="field-type">BOOLEAN</span></td>
                <td>DEFAULT TRUE</td>
                <td>Is template active</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Client Psychology Analysis -->
      <div class="schema-section">
        <h2 style="font-size: 28px; margin-bottom: 20px">
          5. Client Psychology & Job Analysis
        </h2>

        <!-- Client Profiles -->
        <div class="schema-table">
          <div class="table-header">
            <h3>client_psychology_profiles</h3>
            <p style="font-size: 14px; opacity: 0.9">
              Client behavioral analysis and patterns
            </p>
          </div>
          <table>
            <thead>
              <tr>
                <th>Field</th>
                <th>Type</th>
                <th>Constraints</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="field-name">id</span></td>
                <td><span class="field-type">UUID</span></td>
                <td><span class="field-key pk">PK</span></td>
                <td>Client profile ID</td>
              </tr>
              <tr>
                <td><span class="field-name">platform_client_id</span></td>
                <td><span class="field-type">VARCHAR(100)</span></td>
                <td>UNIQUE</td>
                <td>Client ID from platform</td>
              </tr>
              <tr>
                <td><span class="field-name">detected_type</span></td>
                <td><span class="field-type">ENUM</span></td>
                <td>NOT NULL</td>
                <td>Primary psychology type</td>
              </tr>
              <tr>
                <td><span class="field-name">type_confidence</span></td>
                <td><span class="field-type">DECIMAL(3,2)</span></td>
                <td>CHECK (0-1)</td>
                <td>Confidence in classification</td>
              </tr>
              <tr>
                <td><span class="field-name">behavioral_patterns</span></td>
                <td><span class="field-type">JSONB</span></td>
                <td>DEFAULT '{}'</td>
                <td>Observed behaviors</td>
              </tr>
              <tr>
                <td><span class="field-name">communication_style</span></td>
                <td><span class="field-type">JSONB</span></td>
                <td>DEFAULT '{}'</td>
                <td>Communication preferences</td>
              </tr>
              <tr>
                <td><span class="field-name">red_flags</span></td>
                <td><span class="field-type">TEXT[]</span></td>
                <td>DEFAULT '{}'</td>
                <td>Warning indicators</td>
              </tr>
              <tr>
                <td><span class="field-name">success_patterns</span></td>
                <td><span class="field-type">JSONB</span></td>
                <td>DEFAULT '{}'</td>
                <td>What works with this client</td>
              </tr>
              <tr>
                <td><span class="field-name">updated_at</span></td>
                <td><span class="field-type">TIMESTAMP</span></td>
                <td>DEFAULT NOW()</td>
                <td>Last analysis update</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Job Analysis -->
        <div class="schema-table">
          <div class="table-header">
            <h3>job_psychological_analysis</h3>
            <p style="font-size: 14px; opacity: 0.9">
              Psychological analysis of job postings
            </p>
          </div>
          <table>
            <thead>
              <tr>
                <th>Field</th>
                <th>Type</th>
                <th>Constraints</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="field-name">job_id</span></td>
                <td><span class="field-type">UUID</span></td>
                <td>
                  <span class="field-key pk">PK</span>
                  <span class="field-key fk">FK</span>
                </td>
                <td>References jobs.id</td>
              </tr>
              <tr>
                <td><span class="field-name">client_psychology_id</span></td>
                <td><span class="field-type">UUID</span></td>
                <td><span class="field-key fk">FK</span></td>
                <td>References client_psychology_profiles.id</td>
              </tr>
              <tr>
                <td><span class="field-name">urgency_score</span></td>
                <td><span class="field-type">INTEGER</span></td>
                <td>CHECK (0-100)</td>
                <td>Detected urgency level</td>
              </tr>
              <tr>
                <td><span class="field-name">complexity_score</span></td>
                <td><span class="field-type">INTEGER</span></td>
                <td>CHECK (0-100)</td>
                <td>Project complexity</td>
              </tr>
              <tr>
                <td><span class="field-name">clarity_score</span></td>
                <td><span class="field-type">INTEGER</span></td>
                <td>CHECK (0-100)</td>
                <td>Description clarity</td>
              </tr>
              <tr>
                <td><span class="field-name">detected_keywords</span></td>
                <td><span class="field-type">TEXT[]</span></td>
                <td>DEFAULT '{}'</td>
                <td>Psychology indicator keywords</td>
              </tr>
              <tr>
                <td><span class="field-name">recommended_approach</span></td>
                <td><span class="field-type">TEXT</span></td>
                <td>NOT NULL</td>
                <td>Suggested proposal approach</td>
              </tr>
              <tr>
                <td><span class="field-name">success_factors</span></td>
                <td><span class="field-type">JSONB</span></td>
                <td>DEFAULT '{}'</td>
                <td>Key success factors</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Community & Social Features -->
      <div class="schema-section">
        <h2 style="font-size: 28px; margin-bottom: 20px">
          6. Community & Social Support
        </h2>

        <!-- Success Stories -->
        <div class="schema-table">
          <div class="table-header">
            <h3>success_stories</h3>
            <p style="font-size: 14px; opacity: 0.9">
              Anonymous success sharing
            </p>
          </div>
          <table>
            <thead>
              <tr>
                <th>Field</th>
                <th>Type</th>
                <th>Constraints</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="field-name">id</span></td>
                <td><span class="field-type">UUID</span></td>
                <td><span class="field-key pk">PK</span></td>
                <td>Story ID</td>
              </tr>
              <tr>
                <td><span class="field-name">user_id</span></td>
                <td><span class="field-type">UUID</span></td>
                <td><span class="field-key fk">FK</span></td>
                <td>References users.id (hidden)</td>
              </tr>
              <tr>
                <td><span class="field-name">story_type</span></td>
                <td><span class="field-type">VARCHAR(50)</span></td>
                <td>NOT NULL</td>
                <td>Type of success</td>
              </tr>
              <tr>
                <td><span class="field-name">anonymized_details</span></td>
                <td><span class="field-type">JSONB</span></td>
                <td>NOT NULL</td>
                <td>Story details (anonymized)</td>
              </tr>
              <tr>
                <td><span class="field-name">impact_metrics</span></td>
                <td><span class="field-type">JSONB</span></td>
                <td>DEFAULT '{}'</td>
                <td>Quantifiable impacts</td>
              </tr>
              <tr>
                <td><span class="field-name">relevant_segments</span></td>
                <td><span class="field-type">TEXT[]</span></td>
                <td>DEFAULT '{}'</td>
                <td>Which user segments benefit</td>
              </tr>
              <tr>
                <td><span class="field-name">inspiration_count</span></td>
                <td><span class="field-type">INTEGER</span></td>
                <td>DEFAULT 0</td>
                <td>Times marked as inspiring</td>
              </tr>
              <tr>
                <td><span class="field-name">created_at</span></td>
                <td><span class="field-type">TIMESTAMP</span></td>
                <td>DEFAULT NOW()</td>
                <td>When shared</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Accountability Partners -->
        <div class="schema-table">
          <div class="table-header">
            <h3>accountability_partnerships</h3>
            <p style="font-size: 14px; opacity: 0.9">Peer support matching</p>
          </div>
          <table>
            <thead>
              <tr>
                <th>Field</th>
                <th>Type</th>
                <th>Constraints</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="field-name">id</span></td>
                <td><span class="field-type">UUID</span></td>
                <td><span class="field-key pk">PK</span></td>
                <td>Partnership ID</td>
              </tr>
              <tr>
                <td><span class="field-name">user_1_id</span></td>
                <td><span class="field-type">UUID</span></td>
                <td><span class="field-key fk">FK</span></td>
                <td>First partner</td>
              </tr>
              <tr>
                <td><span class="field-name">user_2_id</span></td>
                <td><span class="field-type">UUID</span></td>
                <td><span class="field-key fk">FK</span></td>
                <td>Second partner</td>
              </tr>
              <tr>
                <td><span class="field-name">match_score</span></td>
                <td><span class="field-type">DECIMAL(3,2)</span></td>
                <td>CHECK (0-1)</td>
                <td>Compatibility score</td>
              </tr>
              <tr>
                <td><span class="field-name">match_factors</span></td>
                <td><span class="field-type">JSONB</span></td>
                <td>NOT NULL</td>
                <td>Why they were matched</td>
              </tr>
              <tr>
                <td><span class="field-name">status</span></td>
                <td><span class="field-type">ENUM</span></td>
                <td>DEFAULT 'pending'</td>
                <td>Partnership status</td>
              </tr>
              <tr>
                <td><span class="field-name">check_in_frequency</span></td>
                <td><span class="field-type">VARCHAR(20)</span></td>
                <td>DEFAULT 'daily'</td>
                <td>How often they check in</td>
              </tr>
              <tr>
                <td><span class="field-name">effectiveness_score</span></td>
                <td><span class="field-type">INTEGER</span></td>
                <td>CHECK (0-100)</td>
                <td>Partnership effectiveness</td>
              </tr>
              <tr>
                <td><span class="field-name">created_at</span></td>
                <td><span class="field-type">TIMESTAMP</span></td>
                <td>DEFAULT NOW()</td>
                <td>Partnership start</td>
              </tr>
            </tbody>
          </table>
          <div class="enum-values">
            <strong>status:</strong> 'pending' | 'active' | 'paused' |
            'completed'
          </div>
        </div>
      </div>

      <!-- Analytics & Reporting -->
      <div class="schema-section">
        <h2 style="font-size: 28px; margin-bottom: 20px">
          7. Analytics & Aggregated Data
        </h2>

        <!-- User Psychology Metrics -->
        <div class="schema-table">
          <div class="table-header">
            <h3>user_psychology_metrics</h3>
            <p style="font-size: 14px; opacity: 0.9">
              Aggregated psychological metrics (materialized view)
            </p>
          </div>
          <table>
            <thead>
              <tr>
                <th>Field</th>
                <th>Type</th>
                <th>Constraints</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="field-name">user_id</span></td>
                <td><span class="field-type">UUID</span></td>
                <td>
                  <span class="field-key pk">PK</span>
                  <span class="field-key fk">FK</span>
                </td>
                <td>References users.id</td>
              </tr>
              <tr>
                <td><span class="field-name">avg_confidence_7d</span></td>
                <td><span class="field-type">DECIMAL(5,2)</span></td>
                <td>NULL</td>
                <td>7-day average confidence</td>
              </tr>
              <tr>
                <td><span class="field-name">avg_confidence_30d</span></td>
                <td><span class="field-type">DECIMAL(5,2)</span></td>
                <td>NULL</td>
                <td>30-day average confidence</td>
              </tr>
              <tr>
                <td><span class="field-name">confidence_trend</span></td>
                <td><span class="field-type">VARCHAR(20)</span></td>
                <td>NULL</td>
                <td>Trend direction</td>
              </tr>
              <tr>
                <td><span class="field-name">resilience_score</span></td>
                <td><span class="field-type">INTEGER</span></td>
                <td>CHECK (0-100)</td>
                <td>Current resilience</td>
              </tr>
              <tr>
                <td>
                  <span class="field-name">intervention_responsiveness</span>
                </td>
                <td><span class="field-type">DECIMAL(3,2)</span></td>
                <td>CHECK (0-1)</td>
                <td>How well user responds</td>
              </tr>
              <tr>
                <td><span class="field-name">habit_consistency</span></td>
                <td><span class="field-type">DECIMAL(3,2)</span></td>
                <td>CHECK (0-1)</td>
                <td>Habit completion rate</td>
              </tr>
              <tr>
                <td><span class="field-name">burnout_risk_level</span></td>
                <td><span class="field-type">VARCHAR(20)</span></td>
                <td>NOT NULL</td>
                <td>Current burnout risk</td>
              </tr>
              <tr>
                <td><span class="field-name">last_calculated_at</span></td>
                <td><span class="field-type">TIMESTAMP</span></td>
                <td>DEFAULT NOW()</td>
                <td>Last update time</td>
              </tr>
            </tbody>
          </table>
          <div class="note">
            <strong>Note:</strong> This is a materialized view refreshed every
            hour for performance.
          </div>
        </div>

        <!-- System Learning -->
        <div class="schema-table">
          <div class="table-header">
            <h3>system_learning_events</h3>
            <p style="font-size: 14px; opacity: 0.9">ML model training data</p>
          </div>
          <table>
            <thead>
              <tr>
                <th>Field</th>
                <th>Type</th>
                <th>Constraints</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="field-name">id</span></td>
                <td><span class="field-type">BIGSERIAL</span></td>
                <td><span class="field-key pk">PK</span></td>
                <td>Event ID</td>
              </tr>
              <tr>
                <td><span class="field-name">event_type</span></td>
                <td><span class="field-type">VARCHAR(50)</span></td>
                <td>NOT NULL</td>
                <td>Type of learning event</td>
              </tr>
              <tr>
                <td><span class="field-name">user_segment</span></td>
                <td><span class="field-type">VARCHAR(50)</span></td>
                <td>NULL</td>
                <td>Affected user segment</td>
              </tr>
              <tr>
                <td><span class="field-name">input_context</span></td>
                <td><span class="field-type">JSONB</span></td>
                <td>NOT NULL</td>
                <td>Context before intervention</td>
              </tr>
              <tr>
                <td><span class="field-name">action_taken</span></td>
                <td><span class="field-type">VARCHAR(100)</span></td>
                <td>NOT NULL</td>
                <td>System action/intervention</td>
              </tr>
              <tr>
                <td><span class="field-name">outcome</span></td>
                <td><span class="field-type">JSONB</span></td>
                <td>NOT NULL</td>
                <td>Measured outcome</td>
              </tr>
              <tr>
                <td><span class="field-name">effectiveness</span></td>
                <td><span class="field-type">DECIMAL(3,2)</span></td>
                <td>CHECK (0-1)</td>
                <td>Effectiveness score</td>
              </tr>
              <tr>
                <td><span class="field-name">created_at</span></td>
                <td><span class="field-type">TIMESTAMP</span></td>
                <td>DEFAULT NOW()</td>
                <td>Event timestamp</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Notification & Communication Tracking -->
      <div class="schema-section">
        <h2 style="font-size: 28px; margin-bottom: 20px">
          8. Notification & Communication System
        </h2>

        <!-- Smart Notifications -->
        <div class="schema-table">
          <div class="table-header">
            <h3>smart_notifications</h3>
            <p style="font-size: 14px; opacity: 0.9">
              Psychology-aware notification tracking
            </p>
          </div>
          <table>
            <thead>
              <tr>
                <th>Field</th>
                <th>Type</th>
                <th>Constraints</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="field-name">id</span></td>
                <td><span class="field-type">UUID</span></td>
                <td><span class="field-key pk">PK</span></td>
                <td>Notification ID</td>
              </tr>
              <tr>
                <td><span class="field-name">user_id</span></td>
                <td><span class="field-type">UUID</span></td>
                <td>
                  <span class="field-key fk">FK</span>
                  <span class="field-key idx">IDX</span>
                </td>
                <td>References users.id</td>
              </tr>
              <tr>
                <td><span class="field-name">notification_type</span></td>
                <td><span class="field-type">VARCHAR(50)</span></td>
                <td>NOT NULL</td>
                <td>Type of notification</td>
              </tr>
              <tr>
                <td><span class="field-name">content</span></td>
                <td><span class="field-type">JSONB</span></td>
                <td>NOT NULL</td>
                <td>Notification content</td>
              </tr>
              <tr>
                <td><span class="field-name">user_state_snapshot</span></td>
                <td><span class="field-type">JSONB</span></td>
                <td>NOT NULL</td>
                <td>User state when sent</td>
              </tr>
              <tr>
                <td><span class="field-name">delivery_decision</span></td>
                <td><span class="field-type">JSONB</span></td>
                <td>NOT NULL</td>
                <td>Why sent/not sent</td>
              </tr>
              <tr>
                <td><span class="field-name">channel</span></td>
                <td><span class="field-type">ENUM</span></td>
                <td>NOT NULL</td>
                <td>Delivery channel</td>
              </tr>
              <tr>
                <td><span class="field-name">sent_at</span></td>
                <td><span class="field-type">TIMESTAMP</span></td>
                <td>NULL</td>
                <td>When actually sent</td>
              </tr>
              <tr>
                <td><span class="field-name">opened_at</span></td>
                <td><span class="field-type">TIMESTAMP</span></td>
                <td>NULL</td>
                <td>When user opened</td>
              </tr>
              <tr>
                <td><span class="field-name">acted_at</span></td>
                <td><span class="field-type">TIMESTAMP</span></td>
                <td>NULL</td>
                <td>When user took action</td>
              </tr>
              <tr>
                <td><span class="field-name">effectiveness</span></td>
                <td><span class="field-type">INTEGER</span></td>
                <td>CHECK (0-100)</td>
                <td>Measured effectiveness</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- User Notification Preferences -->
        <div class="schema-table">
          <div class="table-header">
            <h3>user_notification_preferences</h3>
            <p style="font-size: 14px; opacity: 0.9">
              Personalized notification settings
            </p>
          </div>
          <table>
            <thead>
              <tr>
                <th>Field</th>
                <th>Type</th>
                <th>Constraints</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="field-name">user_id</span></td>
                <td><span class="field-type">UUID</span></td>
                <td>
                  <span class="field-key pk">PK</span>
                  <span class="field-key fk">FK</span>
                </td>
                <td>References users.id</td>
              </tr>
              <tr>
                <td><span class="field-name">quiet_hours_start</span></td>
                <td><span class="field-type">TIME</span></td>
                <td>DEFAULT '21:00'</td>
                <td>Daily quiet period start</td>
              </tr>
              <tr>
                <td><span class="field-name">quiet_hours_end</span></td>
                <td><span class="field-type">TIME</span></td>
                <td>DEFAULT '08:00'</td>
                <td>Daily quiet period end</td>
              </tr>
              <tr>
                <td><span class="field-name">max_daily_notifications</span></td>
                <td><span class="field-type">INTEGER</span></td>
                <td>DEFAULT 3</td>
                <td>Maximum per day</td>
              </tr>
              <tr>
                <td><span class="field-name">stress_mode_enabled</span></td>
                <td><span class="field-type">BOOLEAN</span></td>
                <td>DEFAULT FALSE</td>
                <td>Reduce notifications when stressed</td>
              </tr>
              <tr>
                <td><span class="field-name">channel_preferences</span></td>
                <td><span class="field-type">JSONB</span></td>
                <td>DEFAULT '{}'</td>
                <td>Channel-specific settings</td>
              </tr>
              <tr>
                <td>
                  <span class="field-name">notification_personality</span>
                </td>
                <td><span class="field-type">VARCHAR(50)</span></td>
                <td>DEFAULT 'balanced'</td>
                <td>Notification style preference</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Time-based Psychology Tracking -->
      <div class="schema-section">
        <h2 style="font-size: 28px; margin-bottom: 20px">
          9. Time-based Psychology Patterns
        </h2>

        <!-- Daily Patterns -->
        <div class="schema-table">
          <div class="table-header">
            <h3>user_daily_patterns</h3>
            <p style="font-size: 14px; opacity: 0.9">
              Time-of-day behavioral patterns
            </p>
          </div>
          <table>
            <thead>
              <tr>
                <th>Field</th>
                <th>Type</th>
                <th>Constraints</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="field-name">user_id</span></td>
                <td><span class="field-type">UUID</span></td>
                <td>
                  <span class="field-key pk">PK</span>
                  <span class="field-key fk">FK</span>
                </td>
                <td>References users.id</td>
              </tr>
              <tr>
                <td><span class="field-name">hour_of_day</span></td>
                <td><span class="field-type">INTEGER</span></td>
                <td><span class="field-key pk">PK</span> CHECK (0-23)</td>
                <td>Hour (0-23)</td>
              </tr>
              <tr>
                <td><span class="field-name">avg_energy_level</span></td>
                <td><span class="field-type">DECIMAL(3,2)</span></td>
                <td>NULL</td>
                <td>Average energy at this hour</td>
              </tr>
              <tr>
                <td><span class="field-name">avg_productivity</span></td>
                <td><span class="field-type">DECIMAL(3,2)</span></td>
                <td>NULL</td>
                <td>Average productivity</td>
              </tr>
              <tr>
                <td><span class="field-name">success_rate</span></td>
                <td><span class="field-type">DECIMAL(3,2)</span></td>
                <td>NULL</td>
                <td>Application success rate</td>
              </tr>
              <tr>
                <td><span class="field-name">optimal_task_type</span></td>
                <td><span class="field-type">VARCHAR(50)</span></td>
                <td>NULL</td>
                <td>Best task for this hour</td>
              </tr>
              <tr>
                <td><span class="field-name">sample_size</span></td>
                <td><span class="field-type">INTEGER</span></td>
                <td>DEFAULT 0</td>
                <td>Data points for average</td>
              </tr>
              <tr>
                <td><span class="field-name">updated_at</span></td>
                <td><span class="field-type">TIMESTAMP</span></td>
                <td>DEFAULT NOW()</td>
                <td>Last calculation</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Weekly Patterns -->
        <div class="schema-table">
          <div class="table-header">
            <h3>user_weekly_patterns</h3>
            <p style="font-size: 14px; opacity: 0.9">
              Day-of-week behavioral patterns
            </p>
          </div>
          <table>
            <thead>
              <tr>
                <th>Field</th>
                <th>Type</th>
                <th>Constraints</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="field-name">user_id</span></td>
                <td><span class="field-type">UUID</span></td>
                <td>
                  <span class="field-key pk">PK</span>
                  <span class="field-key fk">FK</span>
                </td>
                <td>References users.id</td>
              </tr>
              <tr>
                <td><span class="field-name">day_of_week</span></td>
                <td><span class="field-type">INTEGER</span></td>
                <td><span class="field-key pk">PK</span> CHECK (0-6)</td>
                <td>Day (0=Sunday)</td>
              </tr>
              <tr>
                <td><span class="field-name">activity_level</span></td>
                <td><span class="field-type">DECIMAL(3,2)</span></td>
                <td>NULL</td>
                <td>Overall activity</td>
              </tr>
              <tr>
                <td><span class="field-name">mood_average</span></td>
                <td><span class="field-type">DECIMAL(3,2)</span></td>
                <td>NULL</td>
                <td>Average mood score</td>
              </tr>
              <tr>
                <td><span class="field-name">typical_work_hours</span></td>
                <td><span class="field-type">DECIMAL(4,2)</span></td>
                <td>NULL</td>
                <td>Hours typically worked</td>
              </tr>
              <tr>
                <td><span class="field-name">preferred_activities</span></td>
                <td><span class="field-type">TEXT[]</span></td>
                <td>DEFAULT '{}'</td>
                <td>Preferred tasks this day</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Pricing Psychology -->
      <div class="schema-section">
        <h2 style="font-size: 28px; margin-bottom: 20px">
          10. Pricing Psychology & Confidence
        </h2>

        <!-- Pricing History -->
        <div class="schema-table">
          <div class="table-header">
            <h3>pricing_psychology_events</h3>
            <p style="font-size: 14px; opacity: 0.9">
              Pricing decisions and psychology
            </p>
          </div>
          <table>
            <thead>
              <tr>
                <th>Field</th>
                <th>Type</th>
                <th>Constraints</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="field-name">id</span></td>
                <td><span class="field-type">BIGSERIAL</span></td>
                <td><span class="field-key pk">PK</span></td>
                <td>Event ID</td>
              </tr>
              <tr>
                <td><span class="field-name">user_id</span></td>
                <td><span class="field-type">UUID</span></td>
                <td>
                  <span class="field-key fk">FK</span>
                  <span class="field-key idx">IDX</span>
                </td>
                <td>References users.id</td>
              </tr>
              <tr>
                <td><span class="field-name">job_id</span></td>
                <td><span class="field-type">UUID</span></td>
                <td><span class="field-key fk">FK</span></td>
                <td>References jobs.id</td>
              </tr>
              <tr>
                <td><span class="field-name">event_type</span></td>
                <td><span class="field-type">VARCHAR(50)</span></td>
                <td>NOT NULL</td>
                <td>Type of pricing event</td>
              </tr>
              <tr>
                <td><span class="field-name">quoted_rate</span></td>
                <td><span class="field-type">DECIMAL(10,2)</span></td>
                <td>NOT NULL</td>
                <td>Rate quoted</td>
              </tr>
              <tr>
                <td><span class="field-name">market_rate</span></td>
                <td><span class="field-type">DECIMAL(10,2)</span></td>
                <td>NULL</td>
                <td>Market rate at time</td>
              </tr>
              <tr>
                <td><span class="field-name">confidence_at_quote</span></td>
                <td><span class="field-type">INTEGER</span></td>
                <td>CHECK (0-100)</td>
                <td>User confidence level</td>
              </tr>
              <tr>
                <td><span class="field-name">mindset_position</span></td>
                <td><span class="field-type">INTEGER</span></td>
                <td>CHECK (-100 to 100)</td>
                <td>Scarcity vs abundance</td>
              </tr>
              <tr>
                <td><span class="field-name">outcome</span></td>
                <td><span class="field-type">VARCHAR(50)</span></td>
                <td>NULL</td>
                <td>Accepted/rejected/negotiated</td>
              </tr>
              <tr>
                <td><span class="field-name">created_at</span></td>
                <td><span class="field-type">TIMESTAMP</span></td>
                <td>DEFAULT NOW()</td>
                <td>Event timestamp</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Pricing Confidence -->
        <div class="schema-table">
          <div class="table-header">
            <h3>user_pricing_confidence</h3>
            <p style="font-size: 14px; opacity: 0.9">
              Current pricing confidence state
            </p>
          </div>
          <table>
            <thead>
              <tr>
                <th>Field</th>
                <th>Type</th>
                <th>Constraints</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="field-name">user_id</span></td>
                <td><span class="field-type">UUID</span></td>
                <td>
                  <span class="field-key pk">PK</span>
                  <span class="field-key fk">FK</span>
                </td>
                <td>References users.id</td>
              </tr>
              <tr>
                <td><span class="field-name">current_rate</span></td>
                <td><span class="field-type">DECIMAL(10,2)</span></td>
                <td>NOT NULL</td>
                <td>Current hourly rate</td>
              </tr>
              <tr>
                <td><span class="field-name">market_position</span></td>
                <td><span class="field-type">INTEGER</span></td>
                <td>CHECK (0-100)</td>
                <td>Percentile in market</td>
              </tr>
              <tr>
                <td><span class="field-name">undercharging_amount</span></td>
                <td><span class="field-type">DECIMAL(10,2)</span></td>
                <td>NULL</td>
                <td>How much undercharging</td>
              </tr>
              <tr>
                <td>
                  <span class="field-name">price_increase_readiness</span>
                </td>
                <td><span class="field-type">DECIMAL(3,2)</span></td>
                <td>CHECK (0-1)</td>
                <td>Ready for increase</td>
              </tr>
              <tr>
                <td><span class="field-name">last_increase_date</span></td>
                <td><span class="field-type">DATE</span></td>
                <td>NULL</td>
                <td>Last rate increase</td>
              </tr>
              <tr>
                <td><span class="field-name">increase_strategy</span></td>
                <td><span class="field-type">VARCHAR(50)</span></td>
                <td>NULL</td>
                <td>Recommended strategy</td>
              </tr>
              <tr>
                <td><span class="field-name">updated_at</span></td>
                <td><span class="field-type">TIMESTAMP</span></td>
                <td>DEFAULT NOW()</td>
                <td>Last update</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Database Optimization -->
      <div class="schema-section">
        <h2 style="font-size: 28px; margin-bottom: 20px">
          11. Performance Optimization & Indexes
        </h2>

        <div class="index-info">
          <h3>Critical Performance Indexes</h3>
          <pre class="code-block">
-- Time-series optimization
CREATE INDEX idx_confidence_scores_user_time 
ON confidence_scores(user_id, recorded_at DESC);

CREATE INDEX idx_mood_entries_user_time 
ON mood_entries(user_id, recorded_at DESC);

CREATE INDEX idx_psychological_states_user_time 
ON psychological_states(user_id, recorded_at DESC);

-- Behavioral pattern indexes
CREATE INDEX idx_application_behaviors_user_outcome 
ON application_behaviors(user_id, outcome) 
WHERE outcome IS NOT NULL;

CREATE INDEX idx_streaks_user_type_active 
ON user_streaks(user_id, streak_type) 
WHERE intervention_triggered = FALSE;

-- Intervention optimization
CREATE INDEX idx_interventions_user_response 
ON interventions(user_id, created_at DESC) 
WHERE user_response IS NULL;

CREATE INDEX idx_interventions_effectiveness 
ON interventions(effectiveness DESC) 
WHERE effectiveness IS NOT NULL;

-- Notification delivery
CREATE INDEX idx_notifications_user_pending 
ON smart_notifications(user_id, created_at DESC) 
WHERE sent_at IS NULL;

-- Analytics queries
CREATE INDEX idx_psychology_metrics_burnout 
ON user_psychology_metrics(burnout_risk_level) 
WHERE burnout_risk_level IN ('high', 'critical');

-- Partial indexes for common queries
CREATE INDEX idx_users_active_beginner 
ON users(last_active_at DESC) 
WHERE user_segment = 'new_freelancer';

CREATE INDEX idx_users_struggling 
ON users(id) 
WHERE user_segment = 'struggling';</pre
          >
        </div>

        <div class="index-info" style="margin-top: 20px">
          <h3>Database Partitioning Strategy</h3>
          <pre class="code-block">
-- TimescaleDB hypertables for time-series data
SELECT create_hypertable('confidence_scores', 'recorded_at', 
    chunk_time_interval => INTERVAL '7 days');

SELECT create_hypertable('mood_entries', 'recorded_at', 
    chunk_time_interval => INTERVAL '7 days');

SELECT create_hypertable('psychological_states', 'recorded_at', 
    chunk_time_interval => INTERVAL '7 days');

SELECT create_hypertable('smart_notifications', 'created_at', 
    chunk_time_interval => INTERVAL '30 days');

-- Compression policy for older data
SELECT add_compression_policy('confidence_scores', 
    INTERVAL '30 days');

SELECT add_compression_policy('mood_entries', 
    INTERVAL '30 days');

-- Continuous aggregates for analytics
CREATE MATERIALIZED VIEW confidence_daily_avg
WITH (timescaledb.continuous) AS
SELECT 
    user_id,
    time_bucket('1 day', recorded_at) AS day,
    AVG(score) as avg_score,
    COUNT(*) as measurements
FROM confidence_scores
GROUP BY user_id, day
WITH NO DATA;

-- Refresh policy
SELECT add_continuous_aggregate_policy('confidence_daily_avg',
    start_offset => INTERVAL '3 days',
    end_offset => INTERVAL '1 hour',
    schedule_interval => INTERVAL '1 hour');</pre
          >
        </div>
      </div>

      <!-- Data Privacy & Security -->
      <div class="schema-section">
        <h2 style="font-size: 28px; margin-bottom: 20px">
          12. Data Privacy & Anonymization
        </h2>

        <div class="index-info">
          <h3>Privacy Implementation</h3>
          <pre class="code-block">
-- Row-level security policies
ALTER TABLE psychological_states ENABLE ROW LEVEL SECURITY;

CREATE POLICY user_own_data ON psychological_states
    FOR ALL
    TO application_user
    USING (user_id = current_user_id());

-- Anonymization functions
CREATE OR REPLACE FUNCTION anonymize_location(location TEXT)
RETURNS TEXT AS $
BEGIN
    -- Return only city/state, not exact location
    RETURN regexp_replace(location, '[\d\s]+.*', '');
END;
$ LANGUAGE plpgsql;

CREATE OR REPLACE FUNCTION anonymize_success_story(story JSONB)
RETURNS JSONB AS $
BEGIN
    RETURN story 
        - 'user_name' 
        - 'company_name'
        - 'exact_amount'
        || jsonb_build_object(
            'amount_range', 
            CASE 
                WHEN (story->>'amount')::numeric < 1000 THEN 'under_1k'
                WHEN (story->>'amount')::numeric < 5000 THEN '1k_5k'
                WHEN (story->>'amount')::numeric < 10000 THEN '5k_10k'
                ELSE 'over_10k'
            END,
            'location', anonymize_location(story->>'location')
        );
END;
$ LANGUAGE plpgsql;

-- Audit trail for sensitive data access
CREATE TABLE psychology_data_access_log (
    id BIGSERIAL PRIMARY KEY,
    accessed_by UUID REFERENCES users(id),
    accessed_user_id UUID REFERENCES users(id),
    table_name VARCHAR(50) NOT NULL,
    access_type VARCHAR(20) NOT NULL,
    accessed_at TIMESTAMP DEFAULT NOW()
);

-- Trigger for audit logging
CREATE OR REPLACE FUNCTION log_psychology_access()
RETURNS TRIGGER AS $
BEGIN
    INSERT INTO psychology_data_access_log 
        (accessed_by, accessed_user_id, table_name, access_type)
    VALUES 
        (current_user_id(), NEW.user_id, TG_TABLE_NAME, TG_OP);
    RETURN NEW;
END;
$ LANGUAGE plpgsql;

CREATE TRIGGER audit_psychological_states
    AFTER INSERT OR UPDATE OR DELETE ON psychological_states
    FOR EACH ROW EXECUTE FUNCTION log_psychology_access();</pre
          >
        </div>

        <div class="note">
          <h3>GDPR Compliance Features</h3>
          <ul style="padding-left: 20px; margin-top: 10px">
            <li>
              <strong>Right to Access:</strong> User can export all
              psychological data via API
            </li>
            <li>
              <strong>Right to Deletion:</strong> Cascade delete with
              anonymization of success stories
            </li>
            <li>
              <strong>Data Minimization:</strong> Automatic archival of data
              older than 2 years
            </li>
            <li>
              <strong>Consent Tracking:</strong> Explicit consent for
              psychological profiling
            </li>
            <li>
              <strong>Anonymization:</strong> All shared data is automatically
              anonymized
            </li>
          </ul>
        </div>
      </div>

      <!-- Sample Queries -->
      <div class="schema-section">
        <h2 style="font-size: 28px; margin-bottom: 20px">
          13. Sample Analytics Queries
        </h2>

        <div class="code-block">
          -- 1. User psychological health dashboard WITH recent_state AS (
          SELECT DISTINCT ON (user_id) user_id, confidence_score,
          resilience_score, motivation_level, burnout_risk, mindset_position,
          recorded_at FROM psychological_states WHERE recorded_at > NOW() -
          INTERVAL '24 hours' ORDER BY user_id, recorded_at DESC ), recent_mood
          AS ( SELECT user_id, AVG(mood_value) as avg_mood, AVG(stress_level) as
          avg_stress FROM mood_entries WHERE recorded_at > NOW() - INTERVAL '7
          days' GROUP BY user_id ) SELECT u.id, u.email, u.user_segment,
          rs.confidence_score, rs.resilience_score, rs.burnout_risk,
          rm.avg_mood, rm.avg_stress, CASE WHEN rs.burnout_risk > 0.7 THEN
          'critical' WHEN rs.confidence_score < 40 THEN 'needs_support' WHEN
          rs.resilience_score < 50 THEN 'vulnerable' ELSE 'healthy' END as
          support_priority FROM users u LEFT JOIN recent_state rs ON u.id =
          rs.user_id LEFT JOIN recent_mood rm ON u.id = rm.user_id WHERE
          u.last_active_at > NOW() - INTERVAL '7 days' ORDER BY support_priority
          DESC, rs.confidence_score ASC; -- 2. Intervention effectiveness
          analysis SELECT it.name as intervention_type, COUNT(i.id) as
          times_used, AVG(i.effectiveness_score)::numeric(5,2) as
          avg_effectiveness, SUM(CASE WHEN i.user_response = 'positive' THEN 1
          ELSE 0 END)::float / NULLIF(COUNT(i.id), 0) * 100 as
          positive_response_rate, AVG(EXTRACT(EPOCH FROM (i.responded_at -
          i.created_at))/60)::numeric(10,2) as avg_response_time_minutes FROM
          interventions i JOIN intervention_templates it ON it.id =
          i.intervention_type::uuid WHERE i.created_at > NOW() - INTERVAL '30
          days' GROUP BY it.name ORDER BY avg_effectiveness DESC; -- 3.
          Time-based optimization insights WITH hourly_performance AS ( SELECT
          EXTRACT(HOUR FROM created_at) as hour_of_day, COUNT(*) as
          applications_sent, SUM(CASE WHEN outcome = 'hired' THEN 1 ELSE 0
          END)::float / NULLIF(COUNT(*), 0) * 100 as success_rate,
          AVG(confidence_at_action) as avg_confidence FROM application_behaviors
          WHERE created_at > NOW() - INTERVAL '90 days' GROUP BY hour_of_day )
          SELECT hour_of_day, applications_sent, success_rate::numeric(5,2),
          avg_confidence::numeric(5,2), CASE WHEN success_rate > 20 THEN
          'optimal' WHEN success_rate > 10 THEN 'good' ELSE 'avoid' END as
          recommendation FROM hourly_performance ORDER BY hour_of_day; -- 4.
          Streak pattern analysis SELECT u.user_segment, AVG(CASE WHEN
          s.streak_type = 'wins' THEN s.current_count ELSE 0 END) as
          avg_win_streak, AVG(CASE WHEN s.streak_type = 'losses' THEN
          s.current_count ELSE 0 END) as avg_loss_streak, COUNT(DISTINCT CASE
          WHEN s.intervention_triggered THEN s.user_id END) as
          users_needing_support, COUNT(DISTINCT s.user_id) as total_users FROM
          user_streaks s JOIN users u ON u.id = s.user_id WHERE s.last_event_at
          > NOW() - INTERVAL '7 days' GROUP BY u.user_segment ORDER BY
          avg_loss_streak DESC;
        </div>
      </div>

      <!-- Migration Notes -->
      <div class="schema-section">
        <h2 style="font-size: 28px; margin-bottom: 20px">
          14. Migration & Deployment Notes
        </h2>

        <div class="note">
          <h3>Deployment Sequence</h3>
          <ol style="padding-left: 20px; margin-top: 10px">
            <li>
              <strong>Phase 1 - Core Tables:</strong> Users, profiles, basic
              tracking (Week 1)
            </li>
            <li>
              <strong>Phase 2 - Psychology Tracking:</strong> Confidence, moods,
              states (Week 2)
            </li>
            <li>
              <strong>Phase 3 - Behavioral:</strong> Applications, streaks,
              habits (Week 3)
            </li>
            <li>
              <strong>Phase 4 - Interventions:</strong> Support system tables
              (Week 4)
            </li>
            <li>
              <strong>Phase 5 - Analytics:</strong> Aggregated views, ML tables
              (Week 5)
            </li>
            <li>
              <strong>Phase 6 - Community:</strong> Social features (Week 6)
            </li>
          </ol>
        </div>

        <div class="relationship">
          <h3>Key Relationships Summary</h3>
          <ul style="padding-left: 20px">
            <li>
              <strong>users</strong> → central table, all psychology data
              relates back
            </li>
            <li>
              <strong>psychological_states</strong> → time-series snapshots of
              overall state
            </li>
            <li>
              <strong>interventions</strong> → tracks all system support actions
            </li>
            <li>
              <strong>application_behaviors</strong> → links user psychology to
              job outcomes
            </li>
            <li>
              <strong>smart_notifications</strong> → psychology-aware
              communication
            </li>
          </ul>
        </div>
      </div>
    </div>
  </body>
</html>
